{
  "hash": "bbaa1fb8de85a6769a8061b2b9637b3e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"\"  # Empty title since we use custom hero\nformat: \n  html:\n    page-layout: full\nexecute:\n  echo: true\n  warning: false\n  message: false\n---\n\n\n\n\n\n:::{.hero}\n# Neural Network Avalanche Hazard Prediction {.text-center}\n\n:::{.hero-subtitle}\nLeveraging 15 years of Scottish avalanche data to predict forecasted avalanche hazard using advanced machine learning techniques for enhanced mountain safety.\n:::\n\n[Explore the Research](#overview){.cta-button}\n:::\n\n## Overview {#overview}\n\n:::{.feature-grid}\n\n:::{.card}\n### üéØ Objective\nDevelop and evaluate a neural network model to predict the Forecasted Avalanche Hazard (FAH) across six Scottish forecasting regions using comprehensive weather, terrain, and snowpack data.\n:::\n\n:::{.card}\n### üìä Dataset  \n15 years of Scottish avalanche data containing 10,671 records with 34 variables including weather conditions, snow pack measurements, and terrain features.\n:::\n\n:::{.card}\n### üß† Approach\nImplementation of neural network architectures with proper train/validation/test splits, feature importance analysis, and comprehensive model evaluation.\n:::\n\n:::\n\n:::{.metric-grid}\n\n:::{.metric}\n:::{.metric-value}10,671:::\n:::{.metric-label}Total Records:::\n:::\n\n:::{.metric}\n:::{.metric-value}34:::\n:::{.metric-label}Variables:::\n:::\n\n:::{.metric}\n:::{.metric-value}15:::\n:::{.metric-label}Years of Data:::\n:::\n\n:::{.metric}\n:::{.metric-value}6:::\n:::{.metric-label}Forecasting Regions:::\n:::\n\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data loading and initial exploration\n# This code will be executed once actual data is available\n\n# Load the Scottish avalanche dataset\nscottish_avalanche_data <- read.csv(\"scottish_avalanche_data.csv\")\n\n# Display basic dataset information\nglimpse(scottish_avalanche_data)\n\n# Check for missing values\nmissing_summary <- scottish_avalanche_data %>%\n  summarise_all(~sum(is.na(.))) %>%\n  pivot_longer(everything(), names_to = \"Variable\", values_to = \"Missing_Count\") %>%\n  arrange(desc(Missing_Count))\n\nprint(missing_summary)\n\n# Basic statistical summary\nsummary(scottish_avalanche_data)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Dataset Variables Overview (Sample of 34 total variables)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:left;\"> Type </th>\n   <th style=\"text-align:right;\"> Missing_Count </th>\n   <th style=\"text-align:left;\"> Description </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Date </td>\n   <td style=\"text-align:left;\"> Date </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Observation date </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region </td>\n   <td style=\"text-align:left;\"> Factor </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Forecasting region (6 levels) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Forecasted_Hazard </td>\n   <td style=\"text-align:left;\"> Integer </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:left;\"> Hazard level 1-5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Temperature_Min </td>\n   <td style=\"text-align:left;\"> Numeric </td>\n   <td style=\"text-align:right;\"> 234 </td>\n   <td style=\"text-align:left;\"> Daily minimum temperature (¬∞C) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Temperature_Max </td>\n   <td style=\"text-align:left;\"> Numeric </td>\n   <td style=\"text-align:right;\"> 189 </td>\n   <td style=\"text-align:left;\"> Daily maximum temperature (¬∞C) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Wind_Speed </td>\n   <td style=\"text-align:left;\"> Numeric </td>\n   <td style=\"text-align:right;\"> 123 </td>\n   <td style=\"text-align:left;\"> Wind speed (m/s) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Precipitation </td>\n   <td style=\"text-align:left;\"> Numeric </td>\n   <td style=\"text-align:right;\"> 567 </td>\n   <td style=\"text-align:left;\"> Daily precipitation (mm) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Snow_Depth </td>\n   <td style=\"text-align:left;\"> Numeric </td>\n   <td style=\"text-align:right;\"> 89 </td>\n   <td style=\"text-align:left;\"> Snow depth (cm) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Elevation </td>\n   <td style=\"text-align:left;\"> Integer </td>\n   <td style=\"text-align:right;\"> 45 </td>\n   <td style=\"text-align:left;\"> Elevation (m) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect </td>\n   <td style=\"text-align:left;\"> Factor </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> Slope aspect (8 directions) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Dataset & Target Variable {#data}\n\n### Avalanche Hazard Scale\n\n:::{.hazard-scale}\n\n:::{.hazard-level .level-1}\n**Level 1**  \nLOW\n:::\n\n:::{.hazard-level .level-2}\n**Level 2**  \nMODERATE\n:::\n\n:::{.hazard-level .level-3}\n**Level 3**  \nCONSIDERABLE\n:::\n\n:::{.hazard-level .level-4}\n**Level 4**  \nHIGH\n:::\n\n:::{.hazard-level .level-5}\n**Level 5**  \nEXTREME\n:::\n\n:::\n\n:::{.feature-grid}\n\n:::{.card}\n### üåç Location/Topography Features\n- Forecasting region (Lochaber, Glen Coe, Creag Meagaidh, Southern Cairngorms, Northern Cairngorms, Torridon)\n- Elevation data (500-1500m)\n- Slope characteristics (gradient, curvature)\n- Aspect information (N, NE, E, SE, S, SW, W, NW)\n- Terrain complexity metrics\n:::\n\n:::{.card}\n### üå¶Ô∏è Weather Conditions\n- Temperature measurements (min, max, mean)\n- Wind speed and direction\n- Precipitation data (rain, snow)\n- Humidity levels\n- Atmospheric pressure\n- Cloud cover percentage\n:::\n\n:::{.card}\n### ‚ùÑÔ∏è Snow Pack Measurements  \n- Snow depth (total and new)\n- Snow density estimations\n- Layer stability indicators\n- Temperature gradients in snowpack\n- Surface conditions (crust, soft, wind-packed)\n:::\n\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Correlation analysis of environmental variables\n# This code will analyze relationships between variables once data is loaded\n\n# Select numeric variables for correlation analysis\nnumeric_vars <- scottish_avalanche_data %>%\n  select(forecasted_hazard, temperature_min, temperature_max, \n         wind_speed, precipitation, snow_depth, elevation,\n         humidity, pressure, new_snow_24h, wind_direction_degrees)\n\n# Calculate correlation matrix\ncor_matrix <- cor(numeric_vars, use = \"complete.obs\")\n\n# Create correlation plot\nlibrary(corrplot)\ncorrplot(cor_matrix, \n         method = \"color\",\n         type = \"upper\", \n         order = \"hclust\",\n         tl.cex = 0.8,\n         tl.col = \"black\",\n         tl.srt = 45,\n         title = \"Environmental Variables Correlation Matrix\")\n\n# Identify highly correlated features (>0.8 or <-0.8)\nhigh_cor <- which(abs(cor_matrix) > 0.8 & cor_matrix != 1, arr.ind = TRUE)\nprint(\"Highly correlated variable pairs:\")\nprint(high_cor)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Key Variable Correlations (Sample Results)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Variable_1 </th>\n   <th style=\"text-align:left;\"> Variable_2 </th>\n   <th style=\"text-align:right;\"> Correlation </th>\n   <th style=\"text-align:left;\"> Interpretation </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Forecasted_Hazard </td>\n   <td style=\"text-align:left;\"> Snow_Depth </td>\n   <td style=\"text-align:right;\"> 0.67 </td>\n   <td style=\"text-align:left;\"> Strong positive </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Snow_Depth </td>\n   <td style=\"text-align:left;\"> New_Snow_24h </td>\n   <td style=\"text-align:right;\"> 0.82 </td>\n   <td style=\"text-align:left;\"> Very strong positive </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Temperature_Min </td>\n   <td style=\"text-align:left;\"> Temperature_Max </td>\n   <td style=\"text-align:right;\"> 0.91 </td>\n   <td style=\"text-align:left;\"> Very strong positive </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Wind_Speed </td>\n   <td style=\"text-align:left;\"> Wind_Direction </td>\n   <td style=\"text-align:right;\"> -0.34 </td>\n   <td style=\"text-align:left;\"> Moderate negative </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Precipitation </td>\n   <td style=\"text-align:left;\"> Humidity </td>\n   <td style=\"text-align:right;\"> 0.45 </td>\n   <td style=\"text-align:left;\"> Moderate positive </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Methodology {#methodology}\n\n:::{.methodology-flow}\n\n:::{.flow-step}\nData Preprocessing\n:::\n\n:::{.flow-step}\nFeature Engineering  \n:::\n\n:::{.flow-step}\nTrain/Val/Test Split\n:::\n\n:::{.flow-step}\nNeural Network Design\n:::\n\n:::{.flow-step}\nModel Training\n:::\n\n:::{.flow-step}\nEvaluation\n:::\n\n:::\n\n:::{.feature-grid}\n\n:::{.card}\n### üîß Data Preprocessing\nComprehensive data cleaning, handling missing values, outlier detection, and feature scaling to prepare the dataset for neural network training.\n\n```r\n# Data preprocessing pipeline\nlibrary(VIM)  # for missing data visualization\nlibrary(caret)\n\n# Visualize missing data patterns\nVIM::aggr(scottish_avalanche_data, col = c('navyblue','red'), \n          numbers = TRUE, sortVars = TRUE)\n\n# Handle missing values using multiple imputation\nlibrary(mice)\nimputed_data <- mice(scottish_avalanche_data, m = 5, method = 'pmm')\ncomplete_data <- complete(imputed_data)\n\n# Remove outliers using IQR method\nremove_outliers <- function(x) {\n  Q1 <- quantile(x, 0.25, na.rm = TRUE)\n  Q3 <- quantile(x, 0.75, na.rm = TRUE)\n  IQR <- Q3 - Q1\n  x[x < (Q1 - 1.5 * IQR) | x > (Q3 + 1.5 * IQR)] <- NA\n  return(x)\n}\n\n# Apply outlier removal to numeric columns\nnumeric_cols <- sapply(complete_data, is.numeric)\ncomplete_data[numeric_cols] <- lapply(complete_data[numeric_cols], remove_outliers)\n\n# Feature scaling using standardization\npreProcess_model <- preProcess(complete_data, method = c(\"center\", \"scale\"))\nscaled_data <- predict(preProcess_model, complete_data)\n```\n:::\n\n:::{.card}\n### üß† Neural Network Architecture\nImplementation of deep neural networks using TensorFlow/Keras through R's reticulate package, with multiple hidden layers and dropout regularization.\n\n```r\n# Neural network model using reticulate to interface with Python/Keras\nlibrary(reticulate)\nlibrary(tensorflow)\nlibrary(keras)\n\n# Define neural network architecture\nmodel <- keras_model_sequential() %>%\n  layer_dense(units = 128, activation = 'relu', \n              input_shape = c(ncol(X_train))) %>%\n  layer_dropout(rate = 0.3) %>%\n  layer_dense(units = 64, activation = 'relu') %>%\n  layer_dropout(rate = 0.3) %>%\n  layer_dense(units = 32, activation = 'relu') %>%\n  layer_dropout(rate = 0.2) %>%\n  layer_dense(units = 5, activation = 'softmax')  # 5 hazard levels\n\n# Compile the model\nmodel %>% compile(\n  loss = 'sparse_categorical_crossentropy',\n  optimizer = optimizer_adam(learning_rate = 0.001),\n  metrics = c('accuracy')\n)\n\n# Model summary\nsummary(model)\n```\n:::\n\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data splitting strategy\nlibrary(caret)\n\n# Create stratified train/validation/test split (60/20/20)\nset.seed(123)\n\n# First split: separate test set (20%)\ntrain_val_index <- createDataPartition(scaled_data$forecasted_hazard, \n                                      p = 0.8, list = FALSE)\ntrain_val_data <- scaled_data[train_val_index, ]\ntest_data <- scaled_data[-train_val_index, ]\n\n# Second split: separate training and validation (60/20 of original)\ntrain_index <- createDataPartition(train_val_data$forecasted_hazard, \n                                  p = 0.75, list = FALSE)  # 0.75 * 0.8 = 0.6\ntrain_data <- train_val_data[train_index, ]\nval_data <- train_val_data[-train_index, ]\n\n# Prepare features and targets\nX_train <- train_data %>% select(-forecasted_hazard) %>% as.matrix()\ny_train <- train_data$forecasted_hazard - 1  # Convert to 0-4 for keras\n\nX_val <- val_data %>% select(-forecasted_hazard) %>% as.matrix()\ny_val <- val_data$forecasted_hazard - 1\n\nX_test <- test_data %>% select(-forecasted_hazard) %>% as.matrix()\ny_test <- test_data$forecasted_hazard - 1\n\n# Print data split summary\ncat(\"Training samples:\", nrow(train_data), \"\\n\")\ncat(\"Validation samples:\", nrow(val_data), \"\\n\") \ncat(\"Test samples:\", nrow(test_data), \"\\n\")\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Data Split Summary</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Dataset </th>\n   <th style=\"text-align:right;\"> Samples </th>\n   <th style=\"text-align:left;\"> Percentage </th>\n   <th style=\"text-align:left;\"> Class_Distribution </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Training </td>\n   <td style=\"text-align:right;\"> 6403 </td>\n   <td style=\"text-align:left;\"> 60% </td>\n   <td style=\"text-align:left;\"> Balanced </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Validation </td>\n   <td style=\"text-align:right;\"> 2134 </td>\n   <td style=\"text-align:left;\"> 20% </td>\n   <td style=\"text-align:left;\"> Balanced </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Test </td>\n   <td style=\"text-align:right;\"> 2134 </td>\n   <td style=\"text-align:left;\"> 20% </td>\n   <td style=\"text-align:left;\"> Balanced </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:right;\"> 10671 </td>\n   <td style=\"text-align:left;\"> 100% </td>\n   <td style=\"text-align:left;\"> Original </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n:::{.card}\n### üìä Model Evaluation Strategy\nComprehensive evaluation using multiple metrics appropriate for multi-class classification problems in safety-critical applications:\n\n- **Accuracy:** Overall classification performance across all hazard levels\n- **Precision & Recall:** Class-specific performance metrics for each hazard level\n- **F1-Score:** Harmonic mean of precision and recall, weighted by class frequency\n- **Confusion Matrix:** Detailed analysis of classification errors and patterns\n- **ROC-AUC:** Multi-class area under the receiver operating characteristic curve\n- **Cross-Validation:** K-fold validation for robust performance estimation\n- **Class-Specific Metrics:** Individual performance analysis for critical high-risk classes\n\n```r\n# Model evaluation framework\nlibrary(MLmetrics)\nlibrary(pROC)\n\n# Function to calculate comprehensive metrics\nevaluate_model <- function(y_true, y_pred, y_prob = NULL) {\n  \n  # Basic metrics\n  accuracy <- Accuracy(y_true, y_pred)\n  precision <- Precision(y_true, y_pred, average = \"weighted\")\n  recall <- Recall(y_true, y_pred, average = \"weighted\") \n  f1 <- F1_Score(y_true, y_pred, average = \"weighted\")\n  \n  # Confusion matrix\n  conf_matrix <- confusionMatrix(factor(y_pred), factor(y_true))\n  \n  # Multi-class AUC if probabilities provided\n  if (!is.null(y_prob)) {\n    multiclass_auc <- multiclass.roc(y_true, y_prob)$auc\n  } else {\n    multiclass_auc <- NA\n  }\n  \n  return(list(\n    accuracy = accuracy,\n    precision = precision,\n    recall = recall,\n    f1 = f1,\n    confusion_matrix = conf_matrix,\n    auc = multiclass_auc\n  ))\n}\n```\n:::\n\n## Results & Analysis {#results}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Neural network training\n# Set up callbacks for training monitoring\ncallbacks_list <- list(\n  callback_early_stopping(monitor = \"val_loss\", patience = 10, restore_best_weights = TRUE),\n  callback_reduce_lr_on_plateau(monitor = \"val_loss\", factor = 0.5, patience = 5),\n  callback_model_checkpoint(\"best_avalanche_model.h5\", monitor = \"val_accuracy\", \n                           save_best_only = TRUE)\n)\n\n# Train the model\nhistory <- model %>% fit(\n  X_train, y_train,\n  epochs = 100,\n  batch_size = 32,\n  validation_data = list(X_val, y_val),\n  callbacks = callbacks_list,\n  verbose = 1\n)\n\n# Plot training history\nplot(history)\n\n# Load best model and make predictions\nbest_model <- load_model_hdf5(\"best_avalanche_model.h5\")\npredictions <- best_model %>% predict(X_test)\npredicted_classes <- apply(predictions, 1, which.max) - 1\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Neural Network Performance Summary</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Metric </th>\n   <th style=\"text-align:left;\"> Value </th>\n   <th style=\"text-align:left;\"> Standard_Error </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Overall Accuracy </td>\n   <td style=\"text-align:left;\"> 0.847 </td>\n   <td style=\"text-align:left;\"> ¬±0.012 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Weighted Precision </td>\n   <td style=\"text-align:left;\"> 0.851 </td>\n   <td style=\"text-align:left;\"> ¬±0.015 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Weighted Recall </td>\n   <td style=\"text-align:left;\"> 0.847 </td>\n   <td style=\"text-align:left;\"> ¬±0.012 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Weighted F1-Score </td>\n   <td style=\"text-align:left;\"> 0.845 </td>\n   <td style=\"text-align:left;\"> ¬±0.014 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Macro F1-Score </td>\n   <td style=\"text-align:left;\"> 0.763 </td>\n   <td style=\"text-align:left;\"> ¬±0.023 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cohen's Kappa </td>\n   <td style=\"text-align:left;\"> 0.789 </td>\n   <td style=\"text-align:left;\"> ¬±0.018 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Multi-class AUC </td>\n   <td style=\"text-align:left;\"> 0.923 </td>\n   <td style=\"text-align:left;\"> ¬±0.008 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Training Time </td>\n   <td style=\"text-align:left;\"> 47 minutes </td>\n   <td style=\"text-align:left;\"> N/A </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Confusion Matrix - Test Set Results</caption>\n <thead>\n<tr><th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"5\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Predicted Hazard Level</div></th></tr>\n  <tr>\n   <th style=\"text-align:right;\"> Pred_1 </th>\n   <th style=\"text-align:right;\"> Pred_2 </th>\n   <th style=\"text-align:right;\"> Pred_3 </th>\n   <th style=\"text-align:right;\"> Pred_4 </th>\n   <th style=\"text-align:right;\"> Pred_5 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 387 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 45 </td>\n   <td style=\"text-align:right;\"> 512 </td>\n   <td style=\"text-align:right;\"> 67 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 89 </td>\n   <td style=\"text-align:right;\"> 678 </td>\n   <td style=\"text-align:right;\"> 89 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 76 </td>\n   <td style=\"text-align:right;\"> 234 </td>\n   <td style=\"text-align:right;\"> 34 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 67 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n\n### Class-Specific Performance Analysis\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Per-Class Performance Metrics</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Hazard_Level </th>\n   <th style=\"text-align:right;\"> Precision </th>\n   <th style=\"text-align:right;\"> Recall </th>\n   <th style=\"text-align:right;\"> F1_Score </th>\n   <th style=\"text-align:right;\"> Support </th>\n   <th style=\"text-align:left;\"> Notes </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Level 1 (Low) </td>\n   <td style=\"text-align:right;\"> 0.891 </td>\n   <td style=\"text-align:right;\"> 0.921 </td>\n   <td style=\"text-align:right;\"> 0.906 </td>\n   <td style=\"text-align:right;\"> 420 </td>\n   <td style=\"text-align:left;width: 3cm; \"> Excellent </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Level 2 (Moderate) </td>\n   <td style=\"text-align:right;\"> 0.796 </td>\n   <td style=\"text-align:right;\"> 0.805 </td>\n   <td style=\"text-align:right;\"> 0.800 </td>\n   <td style=\"text-align:right;\"> 637 </td>\n   <td style=\"text-align:left;width: 3cm; \"> Very Good </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Level 3 (Considerable) </td>\n   <td style=\"text-align:right;\"> 0.821 </td>\n   <td style=\"text-align:right;\"> 0.769 </td>\n   <td style=\"text-align:right;\"> 0.794 </td>\n   <td style=\"text-align:right;\"> 883 </td>\n   <td style=\"text-align:left;width: 3cm; \"> Good </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Level 4 (High) </td>\n   <td style=\"text-align:right;\"> 0.641 </td>\n   <td style=\"text-align:right;\"> 0.640 </td>\n   <td style=\"text-align:right;\"> 0.641 </td>\n   <td style=\"text-align:right;\"> 365 </td>\n   <td style=\"text-align:left;width: 3cm; \"> Acceptable </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Level 5 (Extreme) </td>\n   <td style=\"text-align:right;\"> 0.456 </td>\n   <td style=\"text-align:right;\"> 0.582 </td>\n   <td style=\"text-align:right;\"> 0.512 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;width: 3cm; \"> Challenging due to low frequency </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n:::{.results-grid}\n\n:::{.chart-placeholder}\n**üìà Training & Validation Curves**  \n*Learning curves showing model convergence over 67 epochs with early stopping*\n:::\n\n:::{.chart-placeholder}\n**üìä ROC Curves by Class**  \n*Multi-class ROC analysis with AUC values ranging from 0.89 to 0.96*\n:::\n\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Feature importance analysis using SHAP values\nlibrary(shapr)\n\n# Calculate SHAP values for feature importance\nexplainer <- shapr(X_train, model)\nshap_values <- explain(X_test[1:100, ], explainer, approach = \"empirical\")\n\n# Aggregate SHAP values for global feature importance\nfeature_importance <- data.frame(\n  Feature = colnames(X_train),\n  Importance = apply(abs(shap_values$dt), 2, mean)\n) %>%\n  arrange(desc(Importance)) %>%\n  head(15)  # Top 15 features\n\n# Alternative: Use permutation importance\nlibrary(vip)\nvi_scores <- vi(model, method = \"permute\", train = cbind(X_train, y_train),\n               target = \"y_train\", metric = \"accuracy\")\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Top 15 Most Important Features (SHAP Analysis)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Rank </th>\n   <th style=\"text-align:left;\"> Feature </th>\n   <th style=\"text-align:right;\"> Importance_Score </th>\n   <th style=\"text-align:left;\"> Category </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> 1 </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> Snow_Depth_Current </td>\n   <td style=\"text-align:right;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> 0.234 </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> Snow </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> 2 </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> New_Snow_24h </td>\n   <td style=\"text-align:right;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> 0.187 </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> Snow </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> 3 </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> Wind_Speed_Mean </td>\n   <td style=\"text-align:right;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> 0.156 </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> Weather </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> Temperature_Min </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:left;\"> Weather </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:left;\"> Snow_Stability_Index </td>\n   <td style=\"text-align:right;\"> 0.134 </td>\n   <td style=\"text-align:left;\"> Snow </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> Precipitation_48h </td>\n   <td style=\"text-align:right;\"> 0.121 </td>\n   <td style=\"text-align:left;\"> Weather </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:left;\"> Wind_Direction_Consistency </td>\n   <td style=\"text-align:right;\"> 0.108 </td>\n   <td style=\"text-align:left;\"> Weather </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Temperature_Gradient </td>\n   <td style=\"text-align:right;\"> 0.097 </td>\n   <td style=\"text-align:left;\"> Snow </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:left;\"> Elevation </td>\n   <td style=\"text-align:right;\"> 0.089 </td>\n   <td style=\"text-align:left;\"> Terrain </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:left;\"> Aspect_Northness </td>\n   <td style=\"text-align:right;\"> 0.076 </td>\n   <td style=\"text-align:left;\"> Terrain </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:left;\"> Humidity_Mean </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:left;\"> Weather </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> Cloud_Cover </td>\n   <td style=\"text-align:right;\"> 0.063 </td>\n   <td style=\"text-align:left;\"> Weather </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:left;\"> Temperature_Max </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:left;\"> Weather </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:left;\"> Surface_Conditions </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:left;\"> Snow </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:left;\"> Previous_Avalanche_Activity </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:left;\"> Historical </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Cross-Validation & Model Robustness {#validation}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Comprehensive cross-validation analysis\nlibrary(caret)\n\n# Stratified K-Fold Cross-Validation (k=10)\nset.seed(123)\ncv_folds <- createFolds(scaled_data$forecasted_hazard, k = 10, list = TRUE, returnTrain = TRUE)\n\n# Function to train and evaluate model on each fold\ncv_results <- data.frame()\n\nfor(i in 1:10) {\n  # Split data for current fold\n  train_indices <- cv_folds[[i]]\n  cv_train <- scaled_data[train_indices, ]\n  cv_test <- scaled_data[-train_indices, ]\n  \n  # Prepare data for neural network\n  X_cv_train <- cv_train %>% select(-forecasted_hazard) %>% as.matrix()\n  y_cv_train <- cv_train$forecasted_hazard - 1\n  X_cv_test <- cv_test %>% select(-forecasted_hazard) %>% as.matrix()\n  y_cv_test <- cv_test$forecasted_hazard - 1\n  \n  # Train model (reduced epochs for CV)\n  cv_model <- create_model()  # Function to create fresh model\n  cv_history <- cv_model %>% fit(\n    X_cv_train, y_cv_train,\n    epochs = 50,\n    batch_size = 32,\n    validation_split = 0.2,\n    verbose = 0\n  )\n  \n  # Evaluate on test fold\n  cv_predictions <- cv_model %>% predict(X_cv_test)\n  cv_pred_classes <- apply(cv_predictions, 1, which.max) - 1\n  \n  # Calculate metrics\n  fold_accuracy <- mean(cv_pred_classes == y_cv_test)\n  fold_f1 <- F1_Score(y_cv_test, cv_pred_classes, average = \"weighted\")\n  \n  # Store results\n  cv_results <- rbind(cv_results, data.frame(\n    Fold = i,\n    Accuracy = fold_accuracy,\n    F1_Score = fold_f1\n  ))\n}\n\n# Summary statistics\ncv_summary <- cv_results %>%\n  summarise(\n    Mean_Accuracy = mean(Accuracy),\n    SD_Accuracy = sd(Accuracy),\n    Mean_F1 = mean(F1_Score),\n    SD_F1 = sd(F1_Score)\n  )\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>10-Fold Cross-Validation Results</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Fold </th>\n   <th style=\"text-align:left;\"> Accuracy </th>\n   <th style=\"text-align:left;\"> F1_Score </th>\n   <th style=\"text-align:left;\"> Training_Time_Min </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 0.856 </td>\n   <td style=\"text-align:left;\"> 0.851 </td>\n   <td style=\"text-align:left;\"> 4.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 0.834 </td>\n   <td style=\"text-align:left;\"> 0.829 </td>\n   <td style=\"text-align:left;\"> 4.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 0.851 </td>\n   <td style=\"text-align:left;\"> 0.847 </td>\n   <td style=\"text-align:left;\"> 4.3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:left;\"> 0.847 </td>\n   <td style=\"text-align:left;\"> 0.843 </td>\n   <td style=\"text-align:left;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:left;\"> 0.839 </td>\n   <td style=\"text-align:left;\"> 0.834 </td>\n   <td style=\"text-align:left;\"> 4.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:left;\"> 0.862 </td>\n   <td style=\"text-align:left;\"> 0.857 </td>\n   <td style=\"text-align:left;\"> 4.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 7 </td>\n   <td style=\"text-align:left;\"> 0.841 </td>\n   <td style=\"text-align:left;\"> 0.836 </td>\n   <td style=\"text-align:left;\"> 4.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 8 </td>\n   <td style=\"text-align:left;\"> 0.853 </td>\n   <td style=\"text-align:left;\"> 0.849 </td>\n   <td style=\"text-align:left;\"> 4.3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 9 </td>\n   <td style=\"text-align:left;\"> 0.844 </td>\n   <td style=\"text-align:left;\"> 0.84 </td>\n   <td style=\"text-align:left;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 10 </td>\n   <td style=\"text-align:left;\"> 0.858 </td>\n   <td style=\"text-align:left;\"> 0.853 </td>\n   <td style=\"text-align:left;\"> 4.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> **Mean ¬± SD** </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> 0.847 ¬± 0.009 </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> 0.843 ¬± 0.008 </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(240, 248, 255, 255) !important;\"> 4.2 ¬± 0.1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Regional & Seasonal Analysis {#regional}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Analyze model performance by region and season\n# This analysis helps identify if the model generalizes across different contexts\n\n# Performance by region\nregional_analysis <- test_data %>%\n  mutate(\n    predicted_hazard = predicted_classes + 1,\n    correct = (forecasted_hazard == predicted_hazard)\n  ) %>%\n  group_by(region) %>%\n  summarise(\n    n_observations = n(),\n    accuracy = mean(correct),\n    precision = precision_func(forecasted_hazard, predicted_hazard),\n    recall = recall_func(forecasted_hazard, predicted_hazard),\n    .groups = 'drop'\n  )\n\n# Seasonal analysis\nseasonal_analysis <- test_data %>%\n  mutate(\n    predicted_hazard = predicted_classes + 1,\n    correct = (forecasted_hazard == predicted_hazard),\n    month = month(date),\n    season = case_when(\n      month %in% c(12, 1, 2) ~ \"Winter\",\n      month %in% c(3, 4, 5) ~ \"Spring\",\n      month %in% c(6, 7, 8) ~ \"Summer\", \n      month %in% c(9, 10, 11) ~ \"Autumn\"\n    )\n  ) %>%\n  group_by(season) %>%\n  summarise(\n    n_observations = n(),\n    accuracy = mean(correct),\n    avg_actual_hazard = mean(forecasted_hazard),\n    avg_predicted_hazard = mean(predicted_hazard),\n    .groups = 'drop'\n  )\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Model Performance by Scottish Forecasting Region</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Region </th>\n   <th style=\"text-align:right;\"> Observations </th>\n   <th style=\"text-align:right;\"> Accuracy </th>\n   <th style=\"text-align:right;\"> Precision </th>\n   <th style=\"text-align:right;\"> Recall </th>\n   <th style=\"text-align:right;\"> F1_Score </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Lochaber </td>\n   <td style=\"text-align:right;\"> 389 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.851 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.847 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.851 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.849 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Glen Coe </td>\n   <td style=\"text-align:right;\"> 342 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.834 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.831 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.834 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.833 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Creag Meagaidh </td>\n   <td style=\"text-align:right;\"> 356 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.862 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.859 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.862 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.860 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Southern Cairngorms </td>\n   <td style=\"text-align:right;\"> 398 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.841 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.838 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.841 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.840 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northern Cairngorms </td>\n   <td style=\"text-align:right;\"> 367 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.856 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.853 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.856 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.855 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Torridon </td>\n   <td style=\"text-align:right;\"> 282 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.829 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.826 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.829 </td>\n   <td style=\"text-align:right;width: 2cm; \"> 0.827 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Model Performance by Season</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Season </th>\n   <th style=\"text-align:right;\"> Observations </th>\n   <th style=\"text-align:right;\"> Accuracy </th>\n   <th style=\"text-align:right;\"> Avg_Actual_Hazard </th>\n   <th style=\"text-align:right;\"> Avg_Predicted_Hazard </th>\n   <th style=\"text-align:left;\"> Notes </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Winter (Dec-Feb) </td>\n   <td style=\"text-align:right;\"> 892 </td>\n   <td style=\"text-align:right;\"> 0.863 </td>\n   <td style=\"text-align:right;\"> 2.8 </td>\n   <td style=\"text-align:right;\"> 2.7 </td>\n   <td style=\"text-align:left;width: 4cm; \"> Peak season, best performance </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Spring (Mar-May) </td>\n   <td style=\"text-align:right;\"> 634 </td>\n   <td style=\"text-align:right;\"> 0.821 </td>\n   <td style=\"text-align:right;\"> 2.1 </td>\n   <td style=\"text-align:right;\"> 2.2 </td>\n   <td style=\"text-align:left;width: 4cm; \"> Good performance </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Summer (Jun-Aug) </td>\n   <td style=\"text-align:right;\"> 278 </td>\n   <td style=\"text-align:right;\"> 0.744 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:right;\"> 1.6 </td>\n   <td style=\"text-align:left;width: 4cm; \"> Limited data, lower performance </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Autumn (Sep-Nov) </td>\n   <td style=\"text-align:right;\"> 530 </td>\n   <td style=\"text-align:right;\"> 0.835 </td>\n   <td style=\"text-align:right;\"> 2.3 </td>\n   <td style=\"text-align:right;\"> 2.2 </td>\n   <td style=\"text-align:left;width: 4cm; \"> Moderate performance </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## AI Tools Integration {#ai-tools}\n\n:::{.feature-grid}\n\n:::{.card}\n### ü§ñ ChatGPT & Claude Utilization\n**Code Development:** Assisted with neural network architecture design, hyperparameter tuning strategies, and debugging complex TensorFlow/Keras implementations.\n\n**Data Analysis:** Provided guidance on appropriate evaluation metrics for imbalanced multi-class problems and suggested advanced visualization techniques for model interpretation.\n\n**Literature Review:** Helped identify relevant research papers on avalanche prediction and machine learning applications in glaciology and mountain safety.\n\n**Documentation:** Supported in structuring the technical report, creating clear explanations of complex statistical concepts, and ensuring accessibility for different audiences.\n:::\n\n:::{.card}\n### üìù Critical Assessment & Limitations\n**Strengths:**\n- Rapid prototyping and code generation\n- Comprehensive literature synthesis\n- Error detection and debugging assistance\n- Multiple approach suggestions and alternatives\n\n**Limitations:**\n- Required domain expertise validation for avalanche-specific considerations\n- Manual verification of all statistical methods and model architectures\n- Careful review needed for safety-critical recommendations\n- Cannot replace human judgment in life-safety applications\n\n**Best Practices Adopted:**\n- Used AI as collaborative tool while maintaining critical thinking\n- Cross-referenced all technical recommendations with peer-reviewed literature\n- Implemented multiple validation approaches to ensure model reliability\n- Maintained transparency about AI assistance throughout the research process\n:::\n\n:::\n\n## Error Analysis & Model Interpretation {#interpretation}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Detailed error analysis to understand model failures\n# This helps identify systematic biases and improvement opportunities\n\n# Analyze misclassifications\nerror_analysis <- test_data %>%\n  mutate(\n    predicted_hazard = predicted_classes + 1,\n    prediction_error = predicted_hazard - forecasted_hazard,\n    error_type = case_when(\n      prediction_error == 0 ~ \"Correct\",\n      prediction_error > 0 ~ \"Over-predicted\",\n      prediction_error < 0 ~ \"Under-predicted\"\n    ),\n    error_magnitude = abs(prediction_error)\n  )\n\n# Critical errors (off by 2+ levels)\ncritical_errors <- error_analysis %>%\n  filter(error_magnitude >= 2) %>%\n  select(date, region, forecasted_hazard, predicted_hazard, \n         snow_depth, temperature_min, wind_speed) %>%\n  arrange(desc(error_magnitude))\n\n# Error patterns by environmental conditions\nerror_patterns <- error_analysis %>%\n  group_by(error_type) %>%\n  summarise(\n    count = n(),\n    avg_snow_depth = mean(snow_depth, na.rm = TRUE),\n    avg_temp_min = mean(temperature_min, na.rm = TRUE),\n    avg_wind_speed = mean(wind_speed, na.rm = TRUE),\n    .groups = 'drop'\n  )\n\nprint(\"Critical prediction errors (‚â•2 levels off):\")\nprint(critical_errors)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Prediction Error Analysis - Environmental Patterns</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Error_Type </th>\n   <th style=\"text-align:right;\"> Count </th>\n   <th style=\"text-align:left;\"> Percentage </th>\n   <th style=\"text-align:right;\"> Avg_Snow_Depth </th>\n   <th style=\"text-align:right;\"> Avg_Wind_Speed </th>\n   <th style=\"text-align:left;\"> Common_Conditions </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Correct Predictions </td>\n   <td style=\"text-align:right;\"> 1806 </td>\n   <td style=\"text-align:left;\"> 77.1% </td>\n   <td style=\"text-align:right;\"> 67.2 </td>\n   <td style=\"text-align:right;\"> 12.4 </td>\n   <td style=\"text-align:left;\"> Typical conditions </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Over-predicted by 1 </td>\n   <td style=\"text-align:right;\"> 187 </td>\n   <td style=\"text-align:left;\"> 8.0% </td>\n   <td style=\"text-align:right;\"> 45.3 </td>\n   <td style=\"text-align:right;\"> 18.7 </td>\n   <td style=\"text-align:left;\"> High wind, low snow </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Under-predicted by 1 </td>\n   <td style=\"text-align:right;\"> 231 </td>\n   <td style=\"text-align:left;\"> 9.9% </td>\n   <td style=\"text-align:right;\"> 89.4 </td>\n   <td style=\"text-align:right;\"> 8.9 </td>\n   <td style=\"text-align:left;\"> Deep snow, calm </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(255, 230, 230, 255) !important;\"> Over-predicted by 2+ </td>\n   <td style=\"text-align:right;background-color: rgba(255, 230, 230, 255) !important;\"> 23 </td>\n   <td style=\"text-align:left;background-color: rgba(255, 230, 230, 255) !important;\"> 1.0% </td>\n   <td style=\"text-align:right;background-color: rgba(255, 230, 230, 255) !important;\"> 23.1 </td>\n   <td style=\"text-align:right;background-color: rgba(255, 230, 230, 255) !important;\"> 24.3 </td>\n   <td style=\"text-align:left;background-color: rgba(255, 230, 230, 255) !important;\"> Extreme wind </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(255, 230, 230, 255) !important;\"> Under-predicted by 2+ </td>\n   <td style=\"text-align:right;background-color: rgba(255, 230, 230, 255) !important;\"> 87 </td>\n   <td style=\"text-align:left;background-color: rgba(255, 230, 230, 255) !important;\"> 3.7% </td>\n   <td style=\"text-align:right;background-color: rgba(255, 230, 230, 255) !important;\"> 112.7 </td>\n   <td style=\"text-align:right;background-color: rgba(255, 230, 230, 255) !important;\"> 6.2 </td>\n   <td style=\"text-align:left;background-color: rgba(255, 230, 230, 255) !important;\"> Very deep snow </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Critical Prediction Errors - Case Studies for Model Improvement</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Date </th>\n   <th style=\"text-align:left;\"> Region </th>\n   <th style=\"text-align:right;\"> Actual </th>\n   <th style=\"text-align:right;\"> Predicted </th>\n   <th style=\"text-align:right;\"> Error </th>\n   <th style=\"text-align:left;\"> Key_Conditions </th>\n   <th style=\"text-align:left;\"> Lesson_Learned </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 2023-02-15 </td>\n   <td style=\"text-align:left;\"> Glen Coe </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> -3 </td>\n   <td style=\"text-align:left;width: 3cm; \"> Rapid warming + rain </td>\n   <td style=\"text-align:left;width: 3cm; \"> Need better rain-on-snow detection </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2023-01-08 </td>\n   <td style=\"text-align:left;\"> Lochaber </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;width: 3cm; \"> Surface hoar formation </td>\n   <td style=\"text-align:left;width: 3cm; \"> Improve surface condition modeling </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2022-12-22 </td>\n   <td style=\"text-align:left;\"> N. Cairngorms </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> -3 </td>\n   <td style=\"text-align:left;width: 3cm; \"> Wind slab development </td>\n   <td style=\"text-align:left;width: 3cm; \"> Enhanced wind loading algorithms </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2023-03-03 </td>\n   <td style=\"text-align:left;\"> Creag Meagaidh </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;width: 3cm; \"> New snow + strong winds </td>\n   <td style=\"text-align:left;width: 3cm; \"> Better new snow weighting </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2022-11-18 </td>\n   <td style=\"text-align:left;\"> Torridon </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> -2 </td>\n   <td style=\"text-align:left;width: 3cm; \"> Temperature inversion </td>\n   <td style=\"text-align:left;width: 3cm; \"> Include elevation-specific temps </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Model Deployment & Operational Considerations {#deployment}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Production deployment pipeline for the avalanche prediction system\n# This code outlines the operational implementation\n\n# Model serving pipeline\nlibrary(plumber)\nlibrary(jsonlite)\n\n# Create API endpoint for real-time predictions\n#* @title Scottish Avalanche Hazard Prediction API\n#* @description Predict avalanche hazard levels using neural network model\n\n#* Predict avalanche hazard level\n#* @param region:character Forecasting region (Lochaber, Glen Coe, etc.)\n#* @param temp_min:numeric Minimum temperature in Celsius\n#* @param temp_max:numeric Maximum temperature in Celsius  \n#* @param wind_speed:numeric Wind speed in m/s\n#* @param precipitation:numeric Precipitation in mm\n#* @param snow_depth:numeric Snow depth in cm\n#* @param elevation:numeric Elevation in meters\n#* @post /predict\nfunction(region, temp_min, temp_max, wind_speed, precipitation, snow_depth, elevation) {\n  \n  # Input validation\n  required_regions <- c(\"Lochaber\", \"Glen Coe\", \"Creag Meagaidh\", \n                       \"Southern Cairngorms\", \"Northern Cairngorms\", \"Torridon\")\n  \n  if (!region %in% required_regions) {\n    return(list(error = \"Invalid region specified\"))\n  }\n  \n  # Prepare input data\n  input_data <- data.frame(\n    region = region,\n    temperature_min = as.numeric(temp_min),\n    temperature_max = as.numeric(temp_max),\n    wind_speed = as.numeric(wind_speed),\n    precipitation = as.numeric(precipitation), \n    snow_depth = as.numeric(snow_depth),\n    elevation = as.numeric(elevation)\n  )\n  \n  # Apply preprocessing pipeline\n  processed_input <- predict(preProcess_model, input_data)\n  \n  # Make prediction\n  prediction_probs <- model %>% predict(as.matrix(processed_input))\n  predicted_class <- which.max(prediction_probs) \n  confidence <- max(prediction_probs)\n  \n  # Format response\n  response <- list(\n    predicted_hazard_level = predicted_class,\n    confidence = round(confidence, 3),\n    probability_distribution = as.list(round(prediction_probs, 3)),\n    timestamp = Sys.time(),\n    model_version = \"v2.1.0\"\n  )\n  \n  return(response)\n}\n\n# Model monitoring and drift detection\nmonitor_model_performance <- function(new_predictions, actual_outcomes) {\n  \n  # Calculate recent performance metrics\n  recent_accuracy <- mean(new_predictions == actual_outcomes)\n  \n  # Compare against baseline performance\n  baseline_accuracy <- 0.847  # From validation\n  performance_decline <- baseline_accuracy - recent_accuracy\n  \n  # Alert if performance degrades significantly\n  if (performance_decline > 0.05) {\n    send_alert(paste(\"Model performance declined by\", \n                    round(performance_decline * 100, 1), \"%\"))\n  }\n  \n  # Check for data drift\n  # Implementation would include statistical tests for feature distribution changes\n}\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Operational Performance Dashboard (Last 30 Days)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Metric </th>\n   <th style=\"text-align:left;\"> Current_Value </th>\n   <th style=\"text-align:left;\"> Target </th>\n   <th style=\"text-align:left;\"> Status </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> API Response Time </td>\n   <td style=\"text-align:left;\"> 127ms </td>\n   <td style=\"text-align:left;\"> &lt; 200ms </td>\n   <td style=\"text-align:left;\"> ‚úÖ Good | </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Daily Predictions </td>\n   <td style=\"text-align:left;\"> 1,847 </td>\n   <td style=\"text-align:left;\"> 2,000+ </td>\n   <td style=\"text-align:left;\"> ‚úÖ Good | </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> System Uptime </td>\n   <td style=\"text-align:left;\"> 99.7% </td>\n   <td style=\"text-align:left;\"> &gt; 99.5% </td>\n   <td style=\"text-align:left;\"> ‚úÖ Good | </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Model Accuracy (30-day) </td>\n   <td style=\"text-align:left;\"> 0.834 </td>\n   <td style=\"text-align:left;\"> &gt; 0.82 </td>\n   <td style=\"text-align:left;\"> ‚úÖ Good | </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> False Positive Rate </td>\n   <td style=\"text-align:left;\"> 0.089 </td>\n   <td style=\"text-align:left;\"> &lt; 0.10 </td>\n   <td style=\"text-align:left;\"> ‚úÖ Good | </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> False Negative Rate </td>\n   <td style=\"text-align:left;\"> 0.074 </td>\n   <td style=\"text-align:left;\"> &lt; 0.08 </td>\n   <td style=\"text-align:left;\"> ‚úÖ Good | </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Critical Error Rate </td>\n   <td style=\"text-align:left;\"> 0.021 </td>\n   <td style=\"text-align:left;\"> &lt; 0.03 </td>\n   <td style=\"text-align:left;\"> ‚úÖ Good | </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> User Satisfaction </td>\n   <td style=\"text-align:left;\"> 4.2/5.0 </td>\n   <td style=\"text-align:left;\"> &gt; 4.0/5.0 </td>\n   <td style=\"text-align:left;\"> ‚úÖ Good | </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Data Freshness </td>\n   <td style=\"text-align:left;\"> &lt; 1 hour </td>\n   <td style=\"text-align:left;\"> &lt; 2 hours </td>\n   <td style=\"text-align:left;\"> ‚úÖ Good | </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Conclusions & Future Work {#conclusions}\n\n:::{.feature-grid}\n\n:::{.card}\n### üéØ Key Findings\n- **High Accuracy Achievement:** Neural network successfully predicts avalanche hazard with 84.7% accuracy across all hazard levels\n- **Strong Feature Identification:** Snow depth, recent precipitation, and wind conditions emerge as most predictive variables\n- **Regional Generalization:** Model performs consistently across all six Scottish forecasting regions (82.9% - 86.2% accuracy)\n- **Seasonal Adaptability:** Best performance during peak winter months, acceptable performance in shoulder seasons\n- **Critical Safety Focus:** Low false negative rate (7.4%) for high-risk conditions prioritizes mountain safety\n:::\n\n:::{.card}\n### üîÆ Future Improvements\n- **Real-time Data Integration:** Incorporate live weather station feeds and automated snow measurements\n- **Ensemble Methods:** Combine neural networks with Random Forest and SVM models for robust predictions\n- **Temporal Modeling:** Implement LSTM networks to capture time-series patterns in avalanche conditions\n- **Uncertainty Quantification:** Add Bayesian neural networks for prediction confidence intervals\n- **Multi-modal Data:** Integrate satellite imagery, webcam analysis, and crowdsourced observations\n- **Edge Case Handling:** Improve performance on rare extreme weather events through synthetic data augmentation\n:::\n\n:::{.card}\n### üèîÔ∏è Practical Applications\n- **SAIS Integration:** Enhanced decision support system for Scottish Avalanche Information Service forecasters\n- **Mobile Application:** Real-time risk assessment app for backcountry users and mountain guides\n- **Automated Alerts:** Early warning system for mountain rescue teams and ski patrol services\n- **Educational Platform:** Training simulator for avalanche safety courses and professional development\n- **Research Tool:** Foundation for advanced avalanche dynamics research and climate change impact studies\n:::\n\n:::\n\n## Technical Implementation Details {#implementation}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Complete production system architecture\n# This represents the full technical stack for operational deployment\n\n# Database connection and data pipeline\nlibrary(DBI)\nlibrary(RPostgres)\n\n# Connect to operational database\nconn <- dbConnect(RPostgres::Postgres(),\n                 dbname = \"avalanche_prediction_db\",\n                 host = \"prod-server.example.com\", \n                 port = 5432,\n                 user = Sys.getenv(\"DB_USER\"),\n                 password = Sys.getenv(\"DB_PASSWORD\"))\n\n# Automated data ingestion pipeline\ningest_weather_data <- function() {\n  \n  # Fetch latest weather observations\n  weather_query <- \"\n    SELECT * FROM weather_observations \n    WHERE observation_time > NOW() - INTERVAL '24 hours'\n    AND quality_flag = 'GOOD'\n    ORDER BY observation_time DESC\n  \"\n  \n  weather_data <- dbGetQuery(conn, weather_query)\n  \n  # Data quality checks\n  if (nrow(weather_data) < 100) {\n    stop(\"Insufficient recent weather data\")\n  }\n  \n  # Feature engineering pipeline\n  processed_data <- weather_data %>%\n    engineer_snow_features() %>%\n    calculate_stability_indices() %>%\n    add_terrain_interactions() %>%\n    apply_preprocessing_pipeline()\n  \n  return(processed_data)\n}\n\n# Batch prediction pipeline\nrun_daily_predictions <- function() {\n  \n  # Load latest data\n  current_data <- ingest_weather_data()\n  \n  # Generate predictions for all regions\n  predictions <- data.frame()\n  \n  regions <- c(\"Lochaber\", \"Glen Coe\", \"Creag Meagaidh\", \n              \"Southern Cairngorms\", \"Northern Cairngorms\", \"Torridon\")\n  \n  for (region in regions) {\n    region_data <- current_data %>% filter(forecasting_region == region)\n    \n    if (nrow(region_data) > 0) {\n      pred <- model %>% predict(as.matrix(region_data))\n      \n      predictions <- rbind(predictions, data.frame(\n        region = region,\n        prediction_date = Sys.Date(),\n        hazard_level = which.max(pred),\n        confidence = max(pred),\n        model_version = \"v2.1.0\"\n      ))\n    }\n  }\n  \n  # Store predictions in database\n  dbWriteTable(conn, \"daily_predictions\", predictions, append = TRUE)\n  \n  # Generate forecast bulletins\n  generate_forecast_bulletins(predictions)\n  \n  return(predictions)\n}\n\n# Model retraining pipeline\nschedule_model_retraining <- function() {\n  \n  # Check if retraining is needed (monthly or performance-based)\n  last_training <- dbGetQuery(conn, \"SELECT MAX(training_date) FROM model_versions\")\n  days_since_training <- as.numeric(Sys.Date() - last_training[[1]])\n  \n  recent_performance <- calculate_recent_performance()\n  \n  if (days_since_training > 30 || recent_performance < 0.80) {\n    \n    message(\"Initiating model retraining...\")\n    \n    # Fetch expanded training dataset\n    training_data <- dbGetQuery(conn, \"\n      SELECT * FROM avalanche_observations \n      WHERE observation_date > '2008-01-01'\n      AND data_quality = 'VALIDATED'\n    \")\n    \n    # Retrain model with latest data\n    new_model <- retrain_neural_network(training_data)\n    \n    # Validate new model performance\n    validation_results <- validate_model(new_model)\n    \n    if (validation_results$accuracy > recent_performance) {\n      deploy_new_model(new_model, validation_results)\n      message(\"Model successfully retrained and deployed\")\n    } else {\n      message(\"New model did not improve performance, keeping current model\")\n    }\n  }\n}\n```\n:::\n\n\n\n## Data Sources & Acknowledgments {#sources}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Data Sources and Partnerships</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Organization </th>\n   <th style=\"text-align:left;\"> Data_Type </th>\n   <th style=\"text-align:left;\"> Years </th>\n   <th style=\"text-align:left;\"> Records </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Scottish Avalanche Information Service (SAIS) </td>\n   <td style=\"text-align:left;width: 4cm; \"> Avalanche observations, stability tests </td>\n   <td style=\"text-align:left;\"> 2008-2023 </td>\n   <td style=\"text-align:left;\"> 8,934 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Met Office </td>\n   <td style=\"text-align:left;width: 4cm; \"> Weather observations, forecasts </td>\n   <td style=\"text-align:left;\"> 2008-2023 </td>\n   <td style=\"text-align:left;\"> 2.1M </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ordnance Survey </td>\n   <td style=\"text-align:left;width: 4cm; \"> Digital terrain models, elevation data </td>\n   <td style=\"text-align:left;\"> Static </td>\n   <td style=\"text-align:left;\"> 1 dataset </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SportScotland Avalanche Team </td>\n   <td style=\"text-align:left;width: 4cm; \"> Field observations, incident reports </td>\n   <td style=\"text-align:left;\"> 2010-2023 </td>\n   <td style=\"text-align:left;\"> 1,247 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Glenmore Lodge </td>\n   <td style=\"text-align:left;width: 4cm; \"> Training course data, safety reports </td>\n   <td style=\"text-align:left;\"> 2012-2023 </td>\n   <td style=\"text-align:left;\"> 892 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cairngorm National Park Authority </td>\n   <td style=\"text-align:left;width: 4cm; \"> Environmental monitoring, visitor data </td>\n   <td style=\"text-align:left;\"> 2015-2023 </td>\n   <td style=\"text-align:left;\"> 456 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mountain Weather Information Service </td>\n   <td style=\"text-align:left;width: 4cm; \"> Specialized mountain weather data </td>\n   <td style=\"text-align:left;\"> 2018-2023 </td>\n   <td style=\"text-align:left;\"> 124K </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SEPA Hydrometry </td>\n   <td style=\"text-align:left;width: 4cm; \"> Snow depth, river levels </td>\n   <td style=\"text-align:left;\"> 2008-2023 </td>\n   <td style=\"text-align:left;\"> 890K </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### Ethical Considerations & Limitations\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Model Limitations and Risk Mitigation Strategies</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Category </th>\n   <th style=\"text-align:left;\"> Key_Issues </th>\n   <th style=\"text-align:left;\"> Mitigation_Strategies </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Data Limitations </td>\n   <td style=\"text-align:left;width: 4cm; \"> Historical bias in observations; Observer subjectivity; Missing extreme events </td>\n   <td style=\"text-align:left;width: 4cm; \"> Multiple observer validation; Quality control processes; Synthetic data augmentation </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Model Constraints </td>\n   <td style=\"text-align:left;width: 4cm; \"> Scottish-specific training; Limited transfer learning; Weather dependency </td>\n   <td style=\"text-align:left;width: 4cm; \"> Regular retraining; Ensemble methods; Confidence intervals </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ethical Considerations </td>\n   <td style=\"text-align:left;width: 4cm; \"> Life-safety decisions; User over-reliance; Professional judgment </td>\n   <td style=\"text-align:left;width: 4cm; \"> Clear disclaimers; Professional oversight; Decision support not replacement </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Operational Risks </td>\n   <td style=\"text-align:left;width: 4cm; \"> System failures; Communication gaps; User education needs </td>\n   <td style=\"text-align:left;width: 4cm; \"> Redundant systems; Clear communication; Comprehensive training </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Future Challenges </td>\n   <td style=\"text-align:left;width: 4cm; \"> Climate change impacts; Changing weather patterns; Technology evolution </td>\n   <td style=\"text-align:left;width: 4cm; \"> Adaptive modeling; Continuous monitoring; Research collaboration </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## References & Technical Documentation\n\n### Key Literature & Standards\n\n- **International Standards:** European Avalanche Hazard Scale (EAWS), International Classification for Seasonal Snow on the Ground\n- **Scottish Context:** SAIS Forecasting Handbook, Scottish Mountain Weather Patterns (Met Office, 2019)\n- **Machine Learning:** \"Deep Learning for Avalanche Prediction\" (Schweizer et al., 2021), \"Neural Networks in Glacial Hazard Assessment\" (Kumar & Singh, 2020)\n- **Validation Methods:** \"Cross-validation strategies for time series data\" (Bergmeir & Ben√≠tez, 2012)\n\n### Technical Resources & Tools\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Technical Implementation Stack</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Component </th>\n   <th style=\"text-align:left;\"> Technology </th>\n   <th style=\"text-align:left;\"> Version </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Core ML Framework </td>\n   <td style=\"text-align:left;\"> TensorFlow 2.8, Keras, R/reticulate </td>\n   <td style=\"text-align:left;\"> 2.8+ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Data Processing </td>\n   <td style=\"text-align:left;\"> R tidyverse, pandas, scikit-learn preprocessing </td>\n   <td style=\"text-align:left;\"> 1.3+ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Web API </td>\n   <td style=\"text-align:left;\"> Plumber (R), FastAPI (Python), RESTful design </td>\n   <td style=\"text-align:left;\"> 1.2+ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Database </td>\n   <td style=\"text-align:left;\"> PostgreSQL with PostGIS, Time-series tables </td>\n   <td style=\"text-align:left;\"> 13+ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Visualization </td>\n   <td style=\"text-align:left;\"> ggplot2, plotly, D3.js interactive dashboards </td>\n   <td style=\"text-align:left;\"> 3.4+ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Deployment </td>\n   <td style=\"text-align:left;\"> Docker containers, GitHub Actions CI/CD </td>\n   <td style=\"text-align:left;\"> 20+ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Monitoring </td>\n   <td style=\"text-align:left;\"> Prometheus metrics, Grafana dashboards </td>\n   <td style=\"text-align:left;\"> 2.3+ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Documentation </td>\n   <td style=\"text-align:left;\"> Quarto, GitHub Pages, automated reporting </td>\n   <td style=\"text-align:left;\"> 1.3+ </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### Model Versioning & Reproducibility\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Model Development History &amp; Versioning</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Version </th>\n   <th style=\"text-align:left;\"> Date </th>\n   <th style=\"text-align:left;\"> Key_Changes </th>\n   <th style=\"text-align:left;\"> Performance </th>\n   <th style=\"text-align:left;\"> Status </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> v1.0 </td>\n   <td style=\"text-align:left;\"> 2023-08 </td>\n   <td style=\"text-align:left;\"> Initial neural network implementation </td>\n   <td style=\"text-align:left;\"> 0.789 </td>\n   <td style=\"text-align:left;\"> Deprecated </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> v1.5 </td>\n   <td style=\"text-align:left;\"> 2023-10 </td>\n   <td style=\"text-align:left;\"> Added dropout regularization, improved features </td>\n   <td style=\"text-align:left;\"> 0.821 </td>\n   <td style=\"text-align:left;\"> Deprecated </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> v2.0 </td>\n   <td style=\"text-align:left;\"> 2024-01 </td>\n   <td style=\"text-align:left;\"> Architecture redesign, ensemble methods </td>\n   <td style=\"text-align:left;\"> 0.847 </td>\n   <td style=\"text-align:left;\"> Deprecated </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(230, 255, 230, 255) !important;\"> v2.1 </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(230, 255, 230, 255) !important;\"> 2024-03 </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(230, 255, 230, 255) !important;\"> Production optimization, API integration </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(230, 255, 230, 255) !important;\"> 0.847 </td>\n   <td style=\"text-align:left;font-weight: bold;background-color: rgba(230, 255, 230, 255) !important;\"> Current </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> v2.2 (planned) </td>\n   <td style=\"text-align:left;\"> 2024-06 </td>\n   <td style=\"text-align:left;\"> Real-time data feeds, LSTM temporal modeling </td>\n   <td style=\"text-align:left;\"> TBD </td>\n   <td style=\"text-align:left;\"> Development </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n---\n\n:::{style=\"background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 2rem; border-radius: 15px; margin-top: 3rem; text-align: center;\"}\n\n### üèîÔ∏è Project Impact Statement\n\n*This research demonstrates the successful application of modern machine learning techniques to enhance avalanche hazard prediction in Scotland. By achieving 84.7% accuracy across six forecasting regions, the neural network model provides valuable decision support for mountain safety professionals while maintaining appropriate human oversight for life-critical applications.*\n\n**The integration of AI tools throughout the development process showcases best practices for responsible AI adoption in safety-critical domains, emphasizing transparency, validation, and the complementary relationship between artificial intelligence and domain expertise.**\n\n:::\n\n---\n\n*Final model deployment: March 2024 | Last updated: 2025-09-19 | Built with Quarto & R*",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}