{"title":"EDA","markdown":{"yaml":{"title":"EDA","author":"Hope Hennessy","date":"2025-09-17","output":"pdf_document"},"headingText":"Cleaning","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n\nlibrary(tidyverse)\nlibrary(corrplot)\nlibrary(lubridate)\nlibrary(gridExtra)\n```\n\n\n```{r}\ndata <- read.csv(\"~/University/MSc Data Science/STA5073Z_DS Industry/DS-Industry/scotland_avalanche_forecasts_2009_2025.csv\", header = TRUE)\n```\n\n```{r, eval=FALSE}\nhead(data)\ndim(data)\nstr(data)\ntable(data$FAH) # target variable levels\nsummary(data)\n```\n\n\n\n```{r}\n# Only keep rows where the target variable FAH is not missing (-109 rows)\ndata <- data %>% filter(!is.na(FAH) & FAH != \"\")\n\n# Convert categorical target variable to numeric \ndata$FAH <- as.integer(factor(x = data$FAH, levels = c(\"Low\", \"Moderate\", \"Considerable -\", \"Considerable +\", \"High\"))) - 1\ndata$Precip.Code <- as.integer(factor(data$Precip.Code)) - 1\ndata$Area <- as.integer(factor(data$Area)) - 1   # 6 areas\n\n# Create a year variable for date & Month\n# Don't have any data for July, Aug and Sept (summer months) \n# Don't know if a month variable will be important? Should i make those months values be 0?\ndata <- data %>% mutate(Year = year(Date), Month = month(Date))\ntable(data$Month)\n\n# Remove unnecessary columns\ndata <- data %>% select(-OSgrid, -OAH, -Obs, -Location, -Date)\n\n```\n\n# Missing data summary\n\n```{r}\nmissing_summary <- data %>%\n  summarise_all(~sum(is.na(.))) %>%\n  pivot_longer(everything(), names_to = \"Variable\", values_to = \"Missing_Count\") %>%\n  mutate(Missing_Percent = round(Missing_Count / nrow(data) * 100, 1)) %>%\n  arrange(desc(Missing_Count))\nmissing_summary\n\n```\n\n# Cleaning dataset from errors \n\n```{r}\ndata_cleaned <- data %>%\n  mutate(\n    Alt = ifelse(Alt < 0 | Alt > 1345, NA_real_, Alt),\n    Aspect = ifelse(Aspect < 0 | Aspect > 360, NA_real_, Aspect),\n    Incline = ifelse(Incline < 0 | Incline > 90, NA_real_, Incline),\n    Wind.Speed = ifelse(Wind.Speed < 0 | Wind.Speed > 176, NA_real_, Wind.Speed),\n    Cloud = ifelse(Cloud < 0 | Cloud > 100, NA_real_, Cloud),\n    Total.Snow.Depth = ifelse(Total.Snow.Depth < 0 | Total.Snow.Depth > 1500, NA_real_, Total.Snow.Depth),\n    Summit.Wind.Speed = ifelse(Summit.Wind.Speed < 0 | Summit.Wind.Speed > 176, NA_real_, Summit.Wind.Speed),\n    Foot.Pen = ifelse(Foot.Pen < 0 | Foot.Pen > 100, NA_real_, Foot.Pen),\n    Wind.Dir = ifelse(Wind.Dir < 0 | Wind.Dir > 360, NA_real_, Wind.Dir),\n    Summit.Wind.Dir = ifelse(Summit.Wind.Dir < 0 | Summit.Wind.Dir > 360, NA_real_, Summit.Wind.Dir),\n    Snow.Temp = ifelse(Snow.Temp > 0.5, NA_real_, Snow.Temp),\n    Max.Temp.Grad = ifelse(Max.Temp.Grad < 0 | Max.Temp.Grad > 2.5, NA_real_, Max.Temp.Grad))\n\n```\n\n\n```{r}\n# Convert circular variables into two features using sine and cosine transformations\ndata_cleaned <- data_cleaned %>% \n  mutate(Aspect_sin = sin(Aspect * pi / 180), Aspect_cos = cos(Aspect * pi / 180)) %>% \n  mutate(WindDir_sin = sin(Wind.Dir * pi / 180), WindDir_cos = cos(Wind.Dir * pi / 180)) %>%\n  mutate(SummitWindDir_sin = sin(Summit.Wind.Dir * pi / 180), SummitWindDir_cos = cos(Summit.Wind.Dir * pi / 180)) %>%\n  select(-Wind.Dir, -Aspect, -Summit.Wind.Dir)\n\n```\n\n\n```{r}\n# Remove variables with high percentage of missing values or  those that don't make sense\ndata_cleaned <- data_cleaned %>%\n  select(-Ski.Pen, -AV.Cat, -Crystals, -Wetness, -Year, -Snow.Index, -Insolation, -No.Settle)\nnames(data_cleaned)\n```\n\n\nRemoving observations with a plausible Total.Snow.Depth & Foot.Pen values, however, Foot.Pen > Total.Snow.Depth, which is impossible:\n\n```{r}\ndata_cleaned <- data_cleaned %>%\n  filter(Foot.Pen < Total.Snow.Depth)\n```\n\n\n## Missing data summary on cleaned dataset\n\n```{r}\nmissing_summary <- data_cleaned %>%\n  summarise_all(~sum(is.na(.))) %>%\n  pivot_longer(everything(), names_to = \"Variable\", values_to = \"Missing_Count\") %>%\n  mutate(Missing_Percent = round(Missing_Count / nrow(data) * 100, 1)) %>%\n  arrange(desc(Missing_Count))\nmissing_summary\n\n```\n\n\n# I kept longatiude and latitude in. They must be scaled\n\nE.g.\n\n```{r}\ndata_cleaned <- data_cleaned %>%\n  mutate(\n    longitude_scaled = scale(longitude),\n    latitude_scaled = scale(latitude)) %>%\n  select(-longitude, -latitude)  \n\n```\n\n\n\n\n\n# Data & Methods\n\nThe dataset used in this study consists of daily avalanche forecasts for six forecasting regions across Scotland (Creag Meagaidh, Glencoe, Lochaber, Northern Cairngorms, Southern Cairngorms, and Torridon), collected by the Scottish Avalanche Information Service (SAIS) between 2009 and 2025. It contains 10,671 observations and 34 variables including weather conditions, topography, snowpack properties, and avalanche hazard levels.\n\nThe target variable for this project is the Forecast Avalanche Hazard (FAH), a categorical variable with five ordered levels: Low, Moderate, Considerable -, Considerable +, and High. \n\n\n## Data Cleaning and Preprocessing\n\n\nThe raw dataset underwent extensive cleaning prior to analysis. Initially, rows with missing FAH values (109 rows) were removed, and FAH levels were replaced with a numerical representation from 0 to 4 for compatibility with the neural network software. Other categorical variables, such as precipitation type and forecast region, were similarly transformed into numerical formats. The Date column was transformed into Month to capture seasonal effects.\n\nVariables unrelated to forecasting or with high missingness (more than 20%), frequent errors, limited predictive value, or poorly defined measures were excluded, resulting in a set of well-defined predictors most relevant for forecasting. \n\nRange checks were applied to remove physically impossible or implausible values based physical limits and regional context.\n\nFor example, altitude was limited to 0–1,345 m, the height of Ben Nevis (*...*), and wind speeds to 176 mph, reflecting the highest recorded gust in the Highlands (*...*).\n\nSlope inclines were restricted to 0–90°, and wind directions were constrained to 0–360°. Cloud cover was limited to 0–100%, total snow depth to 0–1,500 cm (with unrealistic spikes removed), and foot penetration depth to 100 cm. Snow temperatures above 0.5 °C were flagged as implausible, since snow begins melting at 0 °C, and maximum temperature gradients were limited to below 25 °C per 10 cm (*...*). Observations where foot penetration exceeded total snow depth were also removed.\n\nCircular variables such as wind direction and aspect were transformed into sine and cosine components.\n\nExploratory data analysis (EDA) was then performed to assess variable distributions, relationships with FAH, multicollinearity, and seasonal and geographic trends using correlation heatmaps, histograms, scatterplots, and boxplots.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n\nlibrary(tidyverse)\nlibrary(corrplot)\nlibrary(lubridate)\nlibrary(gridExtra)\n```\n\n\n```{r}\ndata <- read.csv(\"~/University/MSc Data Science/STA5073Z_DS Industry/DS-Industry/scotland_avalanche_forecasts_2009_2025.csv\", header = TRUE)\n```\n\n```{r, eval=FALSE}\nhead(data)\ndim(data)\nstr(data)\ntable(data$FAH) # target variable levels\nsummary(data)\n```\n\n\n# Cleaning\n\n```{r}\n# Only keep rows where the target variable FAH is not missing (-109 rows)\ndata <- data %>% filter(!is.na(FAH) & FAH != \"\")\n\n# Convert categorical target variable to numeric \ndata$FAH <- as.integer(factor(x = data$FAH, levels = c(\"Low\", \"Moderate\", \"Considerable -\", \"Considerable +\", \"High\"))) - 1\ndata$Precip.Code <- as.integer(factor(data$Precip.Code)) - 1\ndata$Area <- as.integer(factor(data$Area)) - 1   # 6 areas\n\n# Create a year variable for date & Month\n# Don't have any data for July, Aug and Sept (summer months) \n# Don't know if a month variable will be important? Should i make those months values be 0?\ndata <- data %>% mutate(Year = year(Date), Month = month(Date))\ntable(data$Month)\n\n# Remove unnecessary columns\ndata <- data %>% select(-OSgrid, -OAH, -Obs, -Location, -Date)\n\n```\n\n# Missing data summary\n\n```{r}\nmissing_summary <- data %>%\n  summarise_all(~sum(is.na(.))) %>%\n  pivot_longer(everything(), names_to = \"Variable\", values_to = \"Missing_Count\") %>%\n  mutate(Missing_Percent = round(Missing_Count / nrow(data) * 100, 1)) %>%\n  arrange(desc(Missing_Count))\nmissing_summary\n\n```\n\n# Cleaning dataset from errors \n\n```{r}\ndata_cleaned <- data %>%\n  mutate(\n    Alt = ifelse(Alt < 0 | Alt > 1345, NA_real_, Alt),\n    Aspect = ifelse(Aspect < 0 | Aspect > 360, NA_real_, Aspect),\n    Incline = ifelse(Incline < 0 | Incline > 90, NA_real_, Incline),\n    Wind.Speed = ifelse(Wind.Speed < 0 | Wind.Speed > 176, NA_real_, Wind.Speed),\n    Cloud = ifelse(Cloud < 0 | Cloud > 100, NA_real_, Cloud),\n    Total.Snow.Depth = ifelse(Total.Snow.Depth < 0 | Total.Snow.Depth > 1500, NA_real_, Total.Snow.Depth),\n    Summit.Wind.Speed = ifelse(Summit.Wind.Speed < 0 | Summit.Wind.Speed > 176, NA_real_, Summit.Wind.Speed),\n    Foot.Pen = ifelse(Foot.Pen < 0 | Foot.Pen > 100, NA_real_, Foot.Pen),\n    Wind.Dir = ifelse(Wind.Dir < 0 | Wind.Dir > 360, NA_real_, Wind.Dir),\n    Summit.Wind.Dir = ifelse(Summit.Wind.Dir < 0 | Summit.Wind.Dir > 360, NA_real_, Summit.Wind.Dir),\n    Snow.Temp = ifelse(Snow.Temp > 0.5, NA_real_, Snow.Temp),\n    Max.Temp.Grad = ifelse(Max.Temp.Grad < 0 | Max.Temp.Grad > 2.5, NA_real_, Max.Temp.Grad))\n\n```\n\n\n```{r}\n# Convert circular variables into two features using sine and cosine transformations\ndata_cleaned <- data_cleaned %>% \n  mutate(Aspect_sin = sin(Aspect * pi / 180), Aspect_cos = cos(Aspect * pi / 180)) %>% \n  mutate(WindDir_sin = sin(Wind.Dir * pi / 180), WindDir_cos = cos(Wind.Dir * pi / 180)) %>%\n  mutate(SummitWindDir_sin = sin(Summit.Wind.Dir * pi / 180), SummitWindDir_cos = cos(Summit.Wind.Dir * pi / 180)) %>%\n  select(-Wind.Dir, -Aspect, -Summit.Wind.Dir)\n\n```\n\n\n```{r}\n# Remove variables with high percentage of missing values or  those that don't make sense\ndata_cleaned <- data_cleaned %>%\n  select(-Ski.Pen, -AV.Cat, -Crystals, -Wetness, -Year, -Snow.Index, -Insolation, -No.Settle)\nnames(data_cleaned)\n```\n\n\nRemoving observations with a plausible Total.Snow.Depth & Foot.Pen values, however, Foot.Pen > Total.Snow.Depth, which is impossible:\n\n```{r}\ndata_cleaned <- data_cleaned %>%\n  filter(Foot.Pen < Total.Snow.Depth)\n```\n\n\n## Missing data summary on cleaned dataset\n\n```{r}\nmissing_summary <- data_cleaned %>%\n  summarise_all(~sum(is.na(.))) %>%\n  pivot_longer(everything(), names_to = \"Variable\", values_to = \"Missing_Count\") %>%\n  mutate(Missing_Percent = round(Missing_Count / nrow(data) * 100, 1)) %>%\n  arrange(desc(Missing_Count))\nmissing_summary\n\n```\n\n\n# I kept longatiude and latitude in. They must be scaled\n\nE.g.\n\n```{r}\ndata_cleaned <- data_cleaned %>%\n  mutate(\n    longitude_scaled = scale(longitude),\n    latitude_scaled = scale(latitude)) %>%\n  select(-longitude, -latitude)  \n\n```\n\n\n\n\n\n# Data & Methods\n\nThe dataset used in this study consists of daily avalanche forecasts for six forecasting regions across Scotland (Creag Meagaidh, Glencoe, Lochaber, Northern Cairngorms, Southern Cairngorms, and Torridon), collected by the Scottish Avalanche Information Service (SAIS) between 2009 and 2025. It contains 10,671 observations and 34 variables including weather conditions, topography, snowpack properties, and avalanche hazard levels.\n\nThe target variable for this project is the Forecast Avalanche Hazard (FAH), a categorical variable with five ordered levels: Low, Moderate, Considerable -, Considerable +, and High. \n\n\n## Data Cleaning and Preprocessing\n\n\nThe raw dataset underwent extensive cleaning prior to analysis. Initially, rows with missing FAH values (109 rows) were removed, and FAH levels were replaced with a numerical representation from 0 to 4 for compatibility with the neural network software. Other categorical variables, such as precipitation type and forecast region, were similarly transformed into numerical formats. The Date column was transformed into Month to capture seasonal effects.\n\nVariables unrelated to forecasting or with high missingness (more than 20%), frequent errors, limited predictive value, or poorly defined measures were excluded, resulting in a set of well-defined predictors most relevant for forecasting. \n\nRange checks were applied to remove physically impossible or implausible values based physical limits and regional context.\n\nFor example, altitude was limited to 0–1,345 m, the height of Ben Nevis (*...*), and wind speeds to 176 mph, reflecting the highest recorded gust in the Highlands (*...*).\n\nSlope inclines were restricted to 0–90°, and wind directions were constrained to 0–360°. Cloud cover was limited to 0–100%, total snow depth to 0–1,500 cm (with unrealistic spikes removed), and foot penetration depth to 100 cm. Snow temperatures above 0.5 °C were flagged as implausible, since snow begins melting at 0 °C, and maximum temperature gradients were limited to below 25 °C per 10 cm (*...*). Observations where foot penetration exceeded total snow depth were also removed.\n\nCircular variables such as wind direction and aspect were transformed into sine and cosine components.\n\nExploratory data analysis (EDA) was then performed to assess variable distributions, relationships with FAH, multicollinearity, and seasonal and geographic trends using correlation heatmaps, histograms, scatterplots, and boxplots.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":"pdf_document","warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":false,"output-file":"EDA.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","theme":"journal","smooth-scroll":true,"anchor-sections":true,"title":"EDA","author":"Hope Hennessy","date":"2025-09-17"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}